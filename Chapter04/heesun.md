## Chapter04 테스트 구축하기

### 4.1 자가 테스트 코드의 가치

>모든 테스트를 완전히 자동화하고 그 결과까지 스스로 검사하게 만들자.

* 테스트 스위트를 사용하자!

켄트 백은 테스트부터 작성하는 습관을 바탕으로 테스트 주도 개발(TDD)이란 기법을 창시했다. 
TDD에서는 (처음에는 통과하지 못할) 테스트를 작성하고, 
이 테스트를 통과하게끔 코드를 작성하고, 결과 코드를 최대한 깔끔하게 리팩터링하는 과정을 
짧은 주기로 반복한다. 이러한 테스트-코딩-리팩터링 과정을 한 시간에도 여러 차례 진행한다.

### 4.2 테스트할 샘플 코드

* 사용자가 생산 계획을 검토하고 수정하도록 해주는 간단한 애플리케이션

### 4.3 첫 번째 테스트

이 코드를 테스트하기 위해서 테스트 프레임워크를 마련한다.

* ex) 테스트 프레임워크로 모카를 사용

>자주 테스트하라. 작성 중인 코드는 최소한 몇 분 간격으로 테스트하고, 적어도 하루에 한 번은
전체 테스트를 돌려보자.

### 4.4 테스트 추가하기

클래스가 하는 일을 모두 살펴보고 각각의 기능에서 오류가 생길 수 있는 조건을 하나씩 테스트한다.

>테스트는 위험 요인을 중심으로 작성해야 한다! 테스트의 목적은 어디까지나 현재 혹은 향후에 발생하는
버그를 찾는 데 있다. 따라서 단순히 필드를 읽고 쓰기만 하는 접근자는 테스트할 필요가 없다.

### 4.5 픽스처 수정하기

```javascript
it('change production', function(){
    asia.producers[0].production = 20;
    expect(asia.shortfall).equal(-6);
    expect(asia.profit).equal(292);
})
```

일반적으로 it 구문 하나당 검증도 하나씩만 하는 게 좋다. 앞쪽 검증을 통과하지 못하면
나머지 검증은 실행해보지 못하고 테스트가 실패하기 때문이다.

* 테스트 단계
* 설정-실행-검증
* 조건-발생-결과
* 준비-수행-단언
  
\* 해체 혹은 청소라고 하는 네 번째 단계도 있는데 명시적으로 언급하지 않을 때가 많다.
해체 단계에서는 픽스처를 제거하여 테스트들이 서로 영향을 주지 못하게 막는다.

### 4.6 경계 조건 검사하기

>문제가 생길 가능성이 있는 경계 조건을 생각해보고 그 부분을 집중적으로 테스트하자.

테스트에도 수확 체감 법칙이 적용된다. 

### 4.7 끝나지 않은 여정

- 단위 테스트

>단위 테스트란?
코드의 작은 영역만을 대상으로 빠르게 실행되도록 설계된 테스트다. 단위 테스트는 
자가 테스트 코드의 핵심이자, 자가 테스트 시스템은 대부분 단위 테스트가 차지한다.

\* 버그 리포트를 받으면 가장 먼저 그 버그를 드러내는 단위 테스트부터 작성하자.



